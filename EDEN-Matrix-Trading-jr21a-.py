'''
#okay and the adventure begins
#  Eden Project is a GPL 3.0 project
#    meaning we are free to use this software so long as the work we do here is shared
#    by all for the betterment of all. Real wealth is security for all.
#    individual wealth is an illusion of security. If you are rich, but your neighbor is poor
#    what does that dynamic do to each other's hearts. We hide away our true nature, true selves
#    as the poor man must dress, speak, act, look and do what the rich men expect
#    The human spirit didn't come here to scrape by. This life is to explore.
#   But we've been tricked into our own traps
#   Fear is an illusion, on the other side of Fear is our Freedom.
#   The end of the old world based on fear and illusion of scarcity.
#

#<one line to give the program's name and a brief idea of what it does.>
#    Copyright (C) <year>  <name of author>
 #
  #    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
 #    the Free Software Foundation, either version 3 of the License, or
  #    (at your option) any later version.#
#
 #   This program is distributed in the hope that it will be useful,#
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
 #   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  #  GNU General Public License for more details.
#
 #   You should have received a copy of the GNU General Public License
  #  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  # Jayson Rahmlow jayson.rahmlow@gmail.com vannyrahmlow@gmail.com
'''

# HELLO MY FRIEND WELCOME TO YOUR 2.INFINITY SELF! THE TIME OF RULE BY FEAR AND IMAGININED SCARCITY IS DYING
# AND SOON WILL BE DEAD.
# THE TIME OF SELF SUFFICIENCY AND SPRIRITUAL, PERSONAL AND HUMAN GROWTH IS HERE.
# THIS TECHNOLOGY SO TO SPEAK CAME TO ME WITH THE AID OF A TELEKINETIC COMMUNICATION WITH A BEING
# IDENTIFYING THEMSELVES AS THE PLEIADIANS. I'M NOT FROM THE NEW AGE WORLD. I HAVE BEEN IN THE
# COMEDY TRACK OF A CAREER IN LOS ANGELES. THIS TALKING TO ALIEN VOICES ISN'T MY WORLD, AND
# I NEVER WOULD HAVE BELIEVED A PERSON TELLING ME THEY HAD BEFORE, SO I DON'T EXPECT YOU TO BELIEVE EITHER ;)
# BUT I PROMISED TO KEEP THIS MESSAGE INCLUDED WITH THE DISTRIBUTION OF THIS MATRIX SOFTWARE. AND THAT
# THE SOFTWARE BE FREELY DISTRIBUTED AND PROTECTED BY GPL 3.0.
# FOR TRUE WEALTH IS ATTAINED WHEN ABUNDANCE IS FOR ALL,
# SO PASS THIS ALONG TO THE PEOPLE IN YOUR LIFE THAT HAVE BEEN GOOD TO YOU.
# ANYONE THAT HAS HURT THEMSELVES TO PROTECT YOU, ANYONE THAT WENT AGAINST THE CROWD SO YOU DIDN'T FEEL ALONE
# THESE ARE THE PEOPLE WE ARE RESTORING OUR FUTURE WITH. THE EMPATHETIC, THE KIND, AND THE TRUE SERVANTS
# OF HUMANITY. A SOCIETY OF DOUBLE BONDED LOVE CONNECTIONS.
# I LOVE YOU
# YOU LOVE ME
# THEN IT MAY BE
# A SYMBIOTIC SOCIETY, WHERE EVIL INTENTIONS ARE CLEAR AS BLACK AND WHITE.
# HOW IS THIS PERSON COMING AT ME, BY LOVE OR BY FEAR
# THOSE IN VIOLENCE, HATE, ANGER, DOMINANCE = COME IN FEAR
# THOSE THAT BARE ABUNDANCE, LOVE, HONESTY, OPEN COMMUNICATION <3 COME IN LOVE
# WE ARE NOT ALONE HERE
# THE PROTECTION FOR THE TRUE OF HEART, IS OF AN UNIMAGINABLY GREAT STRENGTH
# NO FEAR ON THIS PLANET CAN CONTROL THE LOVED
# THE FEAR IS SCARED OF LOVE
# IT KNOWS IT'S ONLY CHANCE OF SURVIVING IS SPREADING ITSELF IN PLACE OF LOVE
# LIKE CARBON MONOXIDE TRICKS OUR LUNGS INTO BELIEVING IT IS OXYGEN
# SO DID THE CENTRAL BANKING SYSTEM,
# PUT IN PLACE TO EMPOWER A NATION,
# INSTEAD IT GROWS CANCERS THROUGHOUT OUR COUNTRIES
# TILL THE PEOPLE ENTRUSTED WITH OUR NATION'S DECISION MAKING POWER, IS SO ROTTEN
# TO ABIDE IT AS A NATION
# WOULD BE TO WAKE UP IN HELL
# THIS IS WHAT HAPPENED. I RESEARCHED #PIZZAGATE AFTER SEEING * MAKE FUN OF IT
# AND I DIDN'T FIND ANY EVIDENCE THAT DEBUNKED IT, JUST PEOPLE ACTING OFFENDED AT ACCUSATIONS
# THE MORE I DUG IN, THE MORE I FOUND AN OCEAN OF EVIDENCE TO THE CONTRARY,
# THAT OUR COUNTRY, ALL COUNTRIES, AND SEEMINGINGLY ALL
# LARGE INSTITUTIONS: CATHOLIC CHURCH, US GOVT, LARGETS CORPS, GOV'T CONTRACTORS: DYNCORP,
# ARE THE HORRORS BOUND AND TIED TO #PEDOGATE
# #PEDOGATE IS THE RITUALISTIC SEXUAL ABUSE AND SACRIFICE OF CHILDREN
# THIS HAPPENS BEHIND ALL THE INTERNATIONAL POWERS AND TRICKLED DOWN TO REGIONAL POWERS
# WANT SOME EVIDENCE, HERE'S JUST A SMALL, SMALL, SMALL, SMALL, AMOUNT,
# NETHERLANDS LARGEST PEDO BUST IN THEIR HISTORY, INVOLVED THEIR CONGRESS AND 2ND IN POWER
# DUPONT HEIR 2013 -
# DIRECTOR OF THE FUGEE'S VIDEO KILLING ME SOFTLY
# THIS FORMER FBI DIRECTOR TRIED TO TELL US FOR 30 YEARS
# THIS BRITISH DOC ABOUT EVIDENCE IGNORED, AND THE JIMMY SAVILLE, AND THE PRIME MINISTER
# AND DENNIS HASTERT (LONGEST SERVING SECRETARY OF STATE U.S., WHO'S MENTIONED IN THE CLINTON EMAILS
# THE POWERS OF THIS WORLD
# HOW DO YOU EXCEL IN THIS WORLD YOU X CELLS OF YOUR COMPETITION
# AKA KILL YOUR NEIGHBORS GROWTH, SURVIVAL OF THE FITTEST
# ARE BOUND TO THEIR POSITIONS OF POWER BY SHARED SHAME
# THEIR WORST MOMENTS CAUGHT ON CAMERA AND USED TO KEEP THEM IN LINE
# EVERY DIGITAL/PAPER STOCK/CURRENCY MARKET WE HAVE SEEN IN OUR LIVES, IS A PREDATORY MARKET
# DON'T FORGET WE MAKE UP THE MARKET, WHAT KIND OF TRADER ARE YOU
# DO YOU BRING FEAR OR SUPPORT TO THE MARKET
# THOSE THAT BRING SUPPORT ADD VALUE
# THOSE THAT BRING FEAR SUPRESS VALUE
# THE ANALOGY WORKS IN THE MARKET AND IS ECHOED IN THE WORLD.
# NO MORE
# THE AGE OF LOVE IS HERE.
# ALL IS GOOD, ALL IS PROTECTED, ALL IN GOOD TIME
# :)

# ANYWAY DOWN TO BUSINESS

# AS BEAUTIFUL AS THIS STRATEGY IS,
# IT STILL REQUIRES 2 THINGS,
# 1. THE MARKET HAS NOT CLOSED FOREVER (THIS IS A VULNERABILITY OF ANY INVESTMENT)
# 2. 0 VOLATILITY FOREVER - (WHICH IN PRACTICE ONLY HAPPENS WHEN GOV'T ENFORCES A PEG, BUT THOSE ALWAYS BREAK)
# SINCE THE ONLY CONSTANT IN MARKETS,
# IS THAT PRICES GO UP AND DOWN:
# WE BUILT A MARKET MACHINE,
# THAT WORKS IN BOTH DIRECTIONS:
# IF MARKET GOES DOWN, YOU LOSE VALUE, GAIN COIN REGENERATION
# IF MARKET GOES UP, YOU GAIN VALUE, LOSE COIN REGENERATION
# SO LETS TAKE WORSE CASE SCENARIO INTO ACCOUNT:
# IF THE MARKET CLOSES TOMORROW OR GETS PEGGED FOREVER BY A GOV'T


# If you find this sample useful, please feel free to donate :)
# LTC: LePiC6JKohb7w6PdFL2KDV1VoZJPFwqXgY
# BTC: 1BzHpzqEVKjDQNCqV67Ju4dYL68aR8jTEe

import httplib
import urllib
import json
import hashlib
import hmac
import time
import requests



'''
THIS PART IS STILL A WORK IN PROGRESS
TRYING TO WRITE AN EASY WAY TO UNDERSTAND THE STRATEGY
SO PEOPLE USING THE SOFTWARE HAVE AN UNDERSTANDING OF HOW IT WORKS :)

Here's a quick explanation of how this works.
In the past, when I would invest,
Say I have $1,000 to invest,
I'm feeling pretty good about amazon, google and apple,
I spend my $1,000 on those 3 stocks,
then wait...
and worry...
Maybe the price goes up,
which is great but,
the whole time I'm stressed,
because even if it's up today,
it could just as easily go down tomorrow,

And say it went down today,
I'm twice as stressed,
because it could go down again tomorrow!
and never come back up!! AHHHHHH!!!!

Now we don't ever know which way the market is going to go,
so this kind of trading is basically gambling.

And I don't like gambling,
it's too freaking stressful,
so I eventually sell off my stocks,
usually at a small loss or gain,
and say I obviously don't know enough about investing,
and I put my money back into a .000001% interest savings account,
in an currency inflating every year by 3 to 7 percent,
and wonder why I'm always broke...

Here's where the infomercial would say,
"But there's got to be a better way!"
(look toward camera, Ding!)

And there is :)

There's one thing we can count on in the markets,
prices will change.
By how much we can't be sure,
but by 1.9% seems to me to be a pretty safe bet.

But for simplicity sake,
and to make the math easy,
lets say the stock we want to buy sells today for $5,
and lets say for arguments sake,
We can bet on 20 percent price swings,
the math of which would look like this:
.2 * $5 = $1
Giving us $1 increments

So what this is saying is,
we think the price will swing $1 one way or the other
pretty frequently over time,
again these numbers will change in practical terms when we actually
want to use this strategy because most markets don't swing a dollar every day,
but again this is for simplicity to explain the idea.

Now after we choose our $1 increments,
we have to set a range we we think the market will live in for the foreseeable future,
So lets set the top of our range,
twice the current $5 market price,
So 2 * $5 = $10
So we don't think the price is going to go above $10 too soon
Now lets set the bottom of our range,
80 percent down from the $5 market price should cover it,
so our bottom range would be $1.

This means we think the market will live betwen $1 and $10 for awhile,
And swing every day by $1 a couple times,

So now lets go back to our $1,000 we want to invest,
instead of buying 200 shares @ $5 today,

lets spread our $1,000 over the whole price range,
so for example,
Lets allocate 1/10 of our investment,
to each $1 price peg,

(Oh yeah and I should mention,
I'll call our $1 increments:
$1, $2, $3, etc, up to $10
pegs from now on.
So if say lets buy 18 of the $5 peg,
that just means lets buy 18 shares @ $5)

so

$100 would buy 10 shares @ $10
$100 would buy 11.1 shares @ $9
$100 would buy 12.5 shares @ $8
$100 would buy 14.3 shares @ $7
$100 would buy 16.6 shares @ $6
$100 would buy 20 shares @ $5
$100 would buy 25 shares @ $4
$100 would buy 33.3 shares @ $3
$100 would buy 50 shares @ $2
$100 would buy 100 shares @ $1



Now the big idea here is that,
every time you buy at one of these pegs,
you then set up a sell,
one peg up,
meaning,
I buy 20 shares @ $5 today,
then I set up a sell for 20 shares @ $6
then market price hits $6,
I now have $120 from my original $100,
I can now reset my $100 buy,
and I have an extra $20 to either cash out,
or reinvest,
I can buy 4 more shares @ $5,
Or I can start filling in the bottom of my matrix below .5,
Or I can add to what I call a moon bucket,
which is the 1st peg above your matrix,
so as you add value from a market swinging back and forth from $5 to $6 dollars,



and dived that by our lower peg of $5, so 120/5
gives u our new $5 peg volume,

and set a buy for $120 @ $5 or 24 shares



Now, lets start to spend some money :)

To decide what to buy today,
we buy up all our pegs at and above current market of $5,
so:
$5, $6, $7, $8, $9 and $10
and with the rest of our investment
we set buys for:
$1, $2, $3, and $4

So we have 6 pegs above market,
so we spend $600 buying them











or

as my wife just reminded me,
we can buy the same volume at each $1 price,
this is a little trickier to explain,
but hey lets try,

so to find your volume,
you sum your price points,
the price points being
$1, $2, $3, $4, $5, $6, $7, $8, $9, $10
If we add all those numbers up we get:
$55

This means the cost to buy one share at each of those pegs adds up to $55
And since we have $1,000 to invest,
Lets find out how many shares we can buy at each price evenly,
$1,000/$55
and we get...
18.1818181818181818on_to_infinity, lets round down to:
18
So we now know we can buy 18 shares at each $1 peg,
that would look like this

We can buy:
18 shares @ $10
18 shares @ $9
18 shares @ $8
18 shares @ $7
18 shares @ $6
18 shares @ $5
18 shares @ $4
18 shares @ $3
18 shares @ $2
18 shares @ $1

So these are two different approaches to the Eden Matrix strategy,
We call the top one: static value,
meaning we buy the same USD value at each price peg,
and the bottom one: static volume,
meaning we buy the same volume, or amount of stocks at each price peg,
for math purposes I'm going to use static value in this example




Lets switch to alt coins instead of the stock market,
this strategy works in any market but I an idealist,
and I believe the power of alt coins is to
not just revolutionize money,
but evolve it, and in the process,
eliminate predatory central banks,
if you haven't found the research yet that proves central banks are predatory,
answer this question,
How is the USA,
which is sold to us as the most powerful,
wealthiest,
beacon of hope, light and freedom,
and all things apple pie and goodness,
and bootstrapped bizness men,
self made entrepreuners,
and the highest concentration of corporatations in the fortune 500,
and military bases in 138 countries around the world,
how is this country 20 trillion dollars in debt,
who is this country 20 trillion dollars in debt too?
when debt is a subserviant position,
Who is this almighty nation in debt to,
the federal reserve,
and why?
Well because the only way a dollar is created in america currently,
is when congress asks the federal reserve,
"oh federal reserve,
pretty please with cherries on top,
can you print some money from nothing,
to lend to us @ interest"
And lucky congress,
the Federal Reserve says sure thing!!!!!
And they print up that 100 billion dollars,
and say hey,
just pay us back 150 billion dollars,
and congress says sure thing! will do!
can't wait! we're a nation of boot strapped engineers,
with creatives bubbling up fuedled with ambition,
no way this country won't make that $150 billion out of the $100 billion,
and we'll all be right as rain.
Except, that $50 billion in interest,
Congress promised to pay as a thank you,
uhmm, one small tiny little detail,
almost insignificant really,
and not worth anyone in congress's attention really,
well that little detail is,
well truth be told,
the $50 billion in interest never was printed.
That's right,
the $100 billion in principle gets printed,








'''




# Use these for testing or Replace with your own API key data

BTC_api_key = "4UJ8ZHCW-LIR3CGIJ-Y2GZAQ92-6CQ7W6IB-1WTYSZ98"
BTC_api_secret = "409431dc77f94b5046ff49343a3d24c852fe2b6bbc701162dda002fe03e30e2d"

# *******************************************************************************************************
# ******************* HARD CODE A MATRIX FOR QUICK AND EASY TEST CASE NMC/BTC ***************************
# *********************n REMOVE ALL THIS HARDCODE WHEN DONE TEST CASE **********************************
# *******************************************************************************************************

# matrix_nmc_usd = [0.5000,0.5095,0.5192,0.5290,0.5391,0.5493,0.5598,0.5704,0.5813,0.5923,0.6035,0.6150,0.6267,0.6386,0.6507,
#                   0.6631,0.6757,0.6885,0.7016,0.7150,0.7285,0.7424,0.7565,0.7709,0.7855,0.8004,0.8156,0.8311,0.8469,0.8630,
#                   0.8794,0.8961,0.9131,0.9305,0.9481,0.9662,0.9846,1.0033,1.0223,1.0417,1.0615,1.0817,1.1023,1.1232,
#                   1.1445,1.1663,1.1885,1.2110,1.2340,1.2575,1.2814,1.3057,1.3558,1.3816,1.4078,1.4346,1.4618,
#                   1.4896,1.5179,1.5467,1.5761,1.6061,1.6366,1.6677,1.6994,1.7317,1.7646,1.7981,1.8323,1.8671,
#                   1.9026,1.9387,1.9755,2.0130,2.0513,2.0903,2.1300,2.1705,2.2117,2.2537,2.2966,2.3402,2.3847,
#                   2.4300,2.4761,2.5232,2.5711,2.6200,2.6700,2.7205,2.7722,2.8248,2.8785,2.9332,2.9889,3.0457,
#                   3.1036,3.1626,3.2227,3.2839,3.3463,3.4099,3.4746,3.5407,3.6079,3.6765,3.7463,3.8175,3.8901,3.9640]

# matrix_trade_state = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
#                       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
#                       0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]


# *******************************************************************************************************
# ********************************* DEFINE FUNCTIONS *********************************************
# *******************************************************************************************************

def generate_matrix(start, end, percentage):
    """Generates the peg matrix and the corresponding trade state matrix."""
    current = start
    matrix = []
    while current <= end:
        matrix.append(current)
        current *= percentage

    trade_state = [ 0 for _ in matrix ]

    return matrix, trade_state


def btce_signed_request(method, params):
    """Makes a signed request to the BTC-e API with the given method and parameters."""

    params["method"] = method
    params["nonce"] = int(round(time.time() - 1398621111, 1) * 10)

    h = hmac.new(BTC_api_secret, digestmod=hashlib.sha512)
    h.update(urllib.urlencode(params))

    trade_headers = {
        "Content-Type": "application/x-www-form-urlencoded",
        "Key": BTC_api_key,
        "Sign": h.hexdigest(),
    }

    response = requests.post("https://btc-e.com/tapi", headers=trade_headers, data=params)

    print '[%s] %s %s' % (method, response.status_code, response.reason)
    return response


def marketdepth(tpair, limit=150):
    """Returns a tuple containing (asks, bids)."""

    resp = requests.get("https://btc-e.com/api/3/depth/" + tpair, params={"limit": limit})
    if resp.status_code == 200:
        data = resp.json()
        data = data.get(tpair)
        return data.get("asks"), data.get("bids")
    else:
        return None, None


def trade(tpair, rate, ttype, amount):
    """Adds a trade order to the exchange.  Returns a tuple with the values (success, order id)."""

    print "Trading tpair " + str(tpair) + " amount is " + str(amount) + " and type is " + str(ttype) + " rate is " + str(rate)
    resp = btce_signed_request("Trade", {
        "pair": tpair,
        "rate": rate,
        "type": ttype,
        "amount": amount,
    })

    if resp.status_code == 200:
        data = resp.json()
        success = data.get("success") == 1
        order_id = data.get("return", {}).get("order_id")
        return success, order_id
    else:
        return False, None


def cancelorder(order_id):
    """Returns True if the order was canceled successfully, False otherwise."""

    resp = btce_signed_request("CancelOrder", {"order_id": order_id})
    if resp.status_code == 200:
        data = resp.json()
        return data.get("success") == 1
    else:
        return False


def activeorders(tpair=None):
    """Returns an array of the user's active orders.  Optional tpair parameter specifies the trading pair."""

    params = {}
    if tpair is not None:
        params["pair"] = tpair

    resp = btce_signed_request("ActiveOrders", params)
    if resp.status_code == 200:
        data = resp.json()
        data = data.get("return")
        if data is None:
            return None

        # the data is returned as a dictionary, so we convert it to an array for convenience
        orders = []
        for order_id, order_data in data.iteritems():
            order_data["order_id"] = order_id # add the order_id to the returned order data
            orders.append(order_data)
        return orders
    else:
        return None


def tradehistory(tpair=None):
    """Returns an array of the user's trades.  Optional tpair parameter specifies the trading pair."""

    params = {}
    if tpair is not None:
        params["pair"] = tpair

    resp = btce_signed_request("TradeHistory", params)

    if resp.status_code == 200:
        data = resp.json()
        data = data.get("return")
        if data is None:
            return None

        # the data is returned as a dictionary, so we convert it to an array for convenience
        trades = []
        for trade_id, trade_data in data.iteritems():
            trade_data["trade_id"] = trade_id # add the trade_id to the returned trade data
            trades.append(trade_data)
        return trades
    else:
        return None


def round_tpair_price(number, tpair):
    return_number = 0
    if tpair == "nmc_usd":
        return_number = round(number, 2)
    else:
        print "ERROR!! Haven't defined round price function for tpair " + tpair
    return return_number


def round_tpair_volume(number, tpair):
    return_number = 0
    if tpair == "nmc_usd":
        return_number = round(number, 4)
    else:
        print "ERROR!! Haven't defined round volume function for tpair " + tpair
    return return_number


# Generate the matrix of pegs (and the corresponding trading state matrix)
matrix_bottom = .5000
matrix_top = 3.9640
matrix_nmc_usd, matrix_trade_state = generate_matrix(matrix_bottom, matrix_top, 1.019)


print "=== NMC/USD market depth:"
asks, bids = marketdepth("nmc_usd")
print "Asks:", asks
print ""
print "Bids:", bids

print ""
print "=== Trade history:"
for trade in tradehistory():
    print trade

print ""
print "=== Active orders:"
#for order in activeorders("nmc_usd"):
#    print order


# *******************************************************************************************************
# ********************************* END OF DEFINE FUNCTIONS *********************************************
# *******************************************************************************************************

# BTC-E MARKET FEE
btc_e_trade_fee = .002

# WHAT AMOUNT OF FIAT ($, EURO, YUAN, YEN) ARE YOU OKAY WITH GIVING UP FOREVER
# TO LEARN FROM THIS EXPERIENCE? What is initial investment amount?

# EDEN STORE VALUE: (USER INITIAL INVESTMENT)
# initial_investment_usd
# JAYSON AND VANNYCAT IF WE ARE GOING NMC TO LTC THIS SHOULDNT BE USE
# ----------> PLEASE CHANGE
initial_investment_usd = 16.50
initial_setup_fee = initial_investment_usd * btc_e_trade_fee
initial_investment_usd -= initial_setup_fee

# EDEN: DISPLAY: "WE WILL CALL THIS YOUR INITIAL INVESTMENT"

# WHAT MARKET WOULD YOU LIKE TO TRADE IN: BTC-E, GDAX, POLONIEX
# PRESS HERE TO LEARN MORE ABOUT EACH EXCHANGE
# exchange_choice
exchange_choice = "btc-e.com"

# USER XCHANGE: BTC-E

# WHAT CURRENCY PAIR WOULD YOU LIKE TO TRADE IN
# USER PAIR Example: LTC/USD
# tpair
tpair = "nmc_usd"


# ***********************************************************************************************************
# ----------> JAYSON AND VANNY THIS CALL TO GET CURRENT MARKET PRICE IS COMMENTED OUT UNTIL WE HAVE INTERNET
# ***********************************************************************************************************


# EDEN: CALL TO (exchange_choice) ASK FOR (tpair) Current Market PRICE
# current_tpair_mprice

if exchange_choice == "btc-e.com":
    depth = marketdepth(tpair, 5)
    if depth is None:
        print "Error connecting to btc-e.com"
        exit(1)

    # Debug make sure these asks look appropriate
    current_tpair_mprice = depth[0][4]


    # In case we need to write out a scratch version
    # f = open("/Users/ApplejackFilms-mbp/Documents/Eden-Project/DepthTest.txt", "w")
    # f.write(str(dict))

    # EDEN: DISPLAY (CURRENT MARKET PRICE): LTC/USD = 15
    # Debug print the market price for us to buy the currency
    print str(current_tpair_mprice)

else:
    print "We don't have software created for markets other than btc-e yet. Stay tuned!"
    current_tpair_mprice = 0
    #exit 1

# REMOVE THIS COMMENTING OUT AND QUERY MARKET FOR CURRENT MARKET PRICE WHEN INTERNET


# ***********************************************************************************************************
# -----> VANNYCAT AND JAYSON REMOVE THIS HARDCODE WHEN OFF OF THE TEST CASE
# ***********************************************************************************************************

current_tpair_mprice = 2

#### this needs to be that grabs this from the api

# EDEN ASK: WHAT PERCENT OF INVESTMENT TO BE PUT IN MOON BASKET/MATRIX - .1, .3, .5?
# Moon basket is a long term hold goal (say you want to pay off a credit card, or a car loan, how @ what price would it take)
# moon_bucket_factor
# example: MOONBASKET FACTOR = .3
# this is what could be a user defined
moon_bucket_factor = .3


# EDEN CALC: (initial_investment_usd)*(moon_bucket_factor) = (moon_basket_current_market_buy_amount) = 300
# moon_basket_current_market_buy_amount# VANNYCAT AND JAYSON NOT USD!
moon_basket_current_market_buy_amount = initial_investment_usd * moon_bucket_factor

# Set the price of the Moonbasket Sell to one peg above the matrix
moon_basket_peg = round_tpair_price((matrix_top * 1.019), "nmc_usd")

# you're matrix won, now what do you want to do with your money

# EDEN: WHAT RATIO OF MATRIX WOULD YOU LIKE TO CHOOSE 60/40 65/35?
# EDEN: EXPLANATION OF BENEFIT OR MARKET CONDITIONS EACH APPROPIATE FOR
matrix_investment = initial_investment_usd - moon_basket_current_market_buy_amount

# this is where we take our remaining $700 (non moon basket) investment and split it in to 2
# $350 would go into a current market buy, those coins would be spread into a peg spread from 1 peg above market to 2 * current market
# $350 would go into buys @ below market peg spreads down to .5 of current market.
# this gives our buys more volume to protect against a falling market price
# this gives our sells less volume but more of a spread and great value for selling off new coins
# USER MATRIX BELOW: .50
# USER MATRIX ABOVE: .50

# .5 * matrix_investment = below_market_buy
# .5 * matrix_investment = above_market_buy
below_market_buy = matrix_investment * .5
above_market_buy = matrix_investment * .5
above_market_coin_count = above_market_buy / current_tpair_mprice

number_of_nmc_usd_pegs = len(matrix_nmc_usd)

starting_tpair_coins = matrix_investment / current_tpair_mprice
nmc_usd_trade_volume = starting_tpair_coins / number_of_nmc_usd_pegs
nmc_usd_trade_volume = round_tpair_volume(nmc_usd_trade_volume, "nmc_usd")


# Uncomment this out when the printout looks good
# EDEN: (current_tpair_mprice)/(moon_basket_current_market_buy_amount) = (moonbasket_coins_count) 20
moonbasket_coins_count = moon_basket_current_market_buy_amount/current_tpair_mprice
moonbasket_coins_count = round_tpair_volume(moonbasket_coins_count, "nmc_usd")


# EDEN: BUY (moonbasket_coins_count) @ (current_tpair_mprice)
# EDEN: AND CONFIRM TRANSACTION
# EDEN: AND CALCULATE THE FEES PAID FOR THE TRANSACTION
#if (exchange_choice == "btc-e.com"):
#    trade_success, order_id = trade(tpair, current_tpair_mprice, "buy", moonbasket_coins_count)
#    print "Purchased moonbucket " + str(moonbasket_coins_count) + " coins at price " + str(current_tpair_mprice)
#    if (trade_success != 777):
#        print "Error Buying Moonbasket coins at market price " + current_tpair_mprice


# EDEN: SET MOONBASKET GOAL SELLS (moonbasket_coins_count @ one peg above matrix top)
# EDEN CREATE SELL moonbasket_coins_count @ moon_basket_peg
if exchange_choice == "btc-e.com":
    trade(tpair, moonbasket_coins_count, "sell", moon_basket_peg)
    print "Put moonbasket sell trade in. Selling " + str(moonbasket_coins_count) + "coins of NMC at price " + str(moon_basket_peg)

exit(1)

# Buy Initial Matrix Investment
# trade_success, order_id = trade(tpair, current_tpair_mprice, "buy", above_market_coin_count)
# print "Purchased initial investment " + str(above_market_coin_count) + " coins at price " + str(current_tpair_mprice)
#if (trade_success != 777):
#    print "Error Buying Above Market Coin Count (Initial Buy) "


# For each peg ask is this peg less than the market price we paid by an amount > the spread of 1.9% (rounded up)
# if so then place a buy at our static volume and
# store the value 1 in our matrix_peg_state (is this the right name?)
# if peg value is greater than market price we paid by 1.9%
# set a sell at our static volume till one below our top peg and
# store the value 2 in our matrix_peg_state
# also for peg <= spread below market
# set matrix_peg_state to 0
# store trade id in matrix_trade_id in index equal to peg index #

list_counter = 0
print str(number_of_nmc_usd_pegs)
for peg in matrix_nmc_usd:
    if peg < current_tpair_mprice:
        if (peg * 1.019) < current_tpair_mprice:
            trade("nmc_usd", peg, "buy", nmc_usd_trade_volume)
            matrix_trade_state[list_counter] = 1
            print "Buy order for " + str(nmc_usd_trade_volume) + "NMC at price " + str(peg)
        else:
            print "No orders at peg " + str(peg)
            matrix_trade_state[list_counter] = 0
    elif peg == current_tpair_mprice:
            print "No orders at peg " + str(peg)
            matrix_trade_state[list_counter] = 0
    else:
        if (peg*.995) > current_tpair_mprice:
            trade("nmc_usd", peg, "sell", nmc_usd_trade_volume)
            matrix_trade_state[list_counter] = 2
            print "Sell order for " + str(nmc_usd_trade_volume) + "NMC at price " + str(peg)
        else:
            print "No orders at peg " + str(peg)
            matrix_trade_state[list_counter] = 0
    list_counter += 1

# ***************************************************************************************************
# *********** CODE WRITTEN 5/12 BY VANNYCAT TO GET RID OF OLD BTC/LTC BUY ORDER AND TO **************
# ******************* SET UP THE NMC/BTC MATRIX WITH ABOVE HARD CODED MATRIX ************************
# ***************************************************************************************************



'''
# Now constantly monitor to get the trade history. For every buy, create a sell order up one peg, for every sell,
# create a buy order down a peg
# number_of_trades = tradehistory("nmc_usd")
tradenum = 0
while tradenum < number_of_trades:

    print "This is " + str(tradenum)

    # ******** Jayson and Vanny - find out how to get at the data in the tradehistory and react accordingly ****
'''